---
layout:     post
title:      Myers差分算法在首页中的应用
subtitle:   从DiffUtil到Myers差量分析算法
date:       2019-04-19
author:     Tristan
header-img: img/post-bg-diff.jpg
catalog: true
tags:
    - DiffUtil
    - Myers
    - RecyclerView
    
---

## 背景
> **首页列表变量更新**，首页的上半身是个列表，列表根据变化内容刷新是必要的；但如果全量更新，则会产生不必要的性能损耗。`通常，用户的每多一次下拉刷新，首页区块都无需更新。`<br/>
> **搭建基础diff工具类**，diff的应用场景很广泛，两组字符串、两个列表之间有何变化都可能需要做diff分析，平台有必要搭建这样一个不受限于业务和具体UI控件的工具类供业务方使用。

## Diff工具类
Android中的diff工具类已经存在，比如下面两个：
- **DiffUtil**，用来比较两个数据集，寻找出旧数据集->新数据集的最小变化量，主要搭配RecyclerView使用。
    
    它的出现满足了数据集变量更新的诉求，刷新数据列表不再一贯地使用notifyDataSetChanged；而使用notifyDataSetChanged存在以下缺点：
  > 1. 不能细化更新项，它是对整个列表进行刷新，性能不够好
  > 2. 刷新操作不能触发动画
  
    RecyclerView的Adapter本身也提供了按位置更新的api，然而没有实现对数据集变量的计算处理；使用这些api，很多时候你还会有这样的困惑：
  > 1. 如何才能知道哪些数据发生了变化
  > 2. 具体发生了什么样的变化（增、删、改）
  > 3. 怎么得到变化数据项的索引位置（相对于旧列表数据）
    
- **AsyncListDiffer**，

有这么好的工具，为什么我们不直接应用到首页列表中呢？
> 只为RecyclerView而生

于此，我们有必要搭建一个不受限于业务和具体UI控件的工具类供平台和业务方使用。

## 使用Myers算法
> DiffUtil的核心算法是Myers
> Git生成diff也用到了Myers

### Myers简介
> 1. 一种diff算法
> 2. 实现了最小的改动

### Myers算法解析
推导
> 图形解释

### “直观”是Myers的特性
> 1. Git生成diff为什么会用到Myers
### 首页列表的diff

